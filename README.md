# **Centos 6.3 Minimal**

Đây là bài viết quá trình mình học OSP201 tại FPTU cơ sở Hòa Lạc (btw t nguyền rủa cái hệ điều hành này)

Phiên bản mình cài là `CentOS 6.3 Minimal x86_64` (Bộ cài á? Hãy tự tìm đi. DIY ngay)

## **Summary**
- Preparing
- Config Network and Package Manager

## **Preparing**
- Học cách sử dụng `vim` vì trong bộ cài và các thứ của mình, **vim** được cài mặc định chứ ko có **nano** hay **emacs** gì cả
- Rèn luyện kĩ năng **Google Dork** và có sự kiên trì trong việc tra cứu

## **Config network and Package Manager**
Sau khi cài CentOS 6.3 bản Minimal, để dùng được mạng và package manager `yum` của CentOS (do sau khi cài xong, cái hệ điều hành này trắng trơn, kể cả `sudo` - khá giống khi cài Arch by hand - và có nhiều package được cài mặc định đã bị lỗi thời nên mình phải update hết):

![](/images/After_config_network.png)

<p align="center"><i>(Đây là sau khi mình đã config lại mạng và cài thêm 1 số cái linh tinh, và thực cũng không có đủ các package hiện đang có đâu)</i></p></br>

- Mặc định máy sẽ không kết nối mạng khi bật lên, nên để dùng mạng khi dùng thì phải config lại ở file `/etc/sysconfig/network-scripts/ifcfg-eth0`, chuyển `ONBOOT` từ `no` thành `yes`

<details>
    <summary> Config </summary>

```
DEVICE="eth0"
BOOTPROTO="dhcp"
HWADDR="xx:xx:xx:xx:xx:xx"
NM_CONTROLLED="yes"
ONBOOT="yes"
TYPE="Ethernet"
UUID="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
```

</details></br>

- Chỉnh lại IPv4 nameserver ở file `/etc/resolv.conf` (Nhớ tạo file backup)

<details>
    <summary>Config</summary>

```
; generated by /sbin/dhclient-script
nameserver 8.8.8.8
nameserver 8.8.4.4
```

</details></br>

- Chỉnh lại mirror (repos gì đó) tại `/etc/yum.repos.d/CentOS-Base.repo`. Mình sẽ chỉnh lại baseurl và không dùng mirrorlist, mình sẽ chỉnh baseurl dùng `http://archive.kernel.org/centos-vault/6.3/` và chỉnh mỗi 3 đầu mục là `base`, `updates`, `extras`  (Nhớ tạo file backup)

<details>
    <summary>Config</summary>

```
...
[base]
name=CentOS-$releasever - Base
#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=os
#baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/
baseurl=http://archive.kernel.org/centos-vault/6.3/os/$basearch/
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6

#released updates
[updates]
name=CentOS-$releasever - Extras
#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=updates
#baseurl=http://mirror.centos.org/centos/$releasever/updates/$basearch/
baseurl=http://archive.kernel.org/centos-vault/6.3/updates/$basearch/
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6

#additional packages that may be useful
[extras]
name=CentOS-$releasever - Extras
#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=extras
#baseurl=http://mirror.centos.org/centos/$releasever/extras/$basearch/
baseurl=http://archive.kernel.org/centos-vault/6.3/extras/$basearch/
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6

...
```

</details></br>

Sau khi config mạng xong, để có thể xài package manager `apt-get` cho giống các họ hàng nhà Debian, mình có thể tìm trên mạng nhưng mình khuyên không nên dùng cái này. Mình sẽ cần cài `sudo`, `ntp` và update cũng như upgrade toàn bộ package đang có

## **Add User to sudoers**

OK, cài `sudo` xong, mình sẽ cần add user thường vào (user được yêu cầu phải tạo khi làm bài LAB)
Sửa tại file `/etc/sudoers` (Nhớ backup trước khi làm). Trước khi để có thể sửa được file `sudoers`, mình cần cấp quyền ghi cho nó vì mặc định nó ở chỉ có quyền đọc ở user và local (440 - hãy tìm hiểu thêm về cái này để hiểu được các con số có ý nghĩa gì và tác động lên file như thế nào)

```bash
[root@OSP201 etc]# chmod 640 sudoers
```

Sau khi cấp quyền ghi, mình sẽ dùng *vim* để sửa file. Mình cần tìm cái `## Allow people in group wheel to run all commands`. Tùy vào việc muốn sử dụng password khi dùng *sudo* hay không mà thêm vào.

- Với việc muốn dùng password (Recommend), sẽ thêm theo cú pháp `yourusername ALL=(ALL) ALL` vào sau dòng đó

<details>
    <summary>Config</summary>

```
...
## Allows people in group wheel to run all commands
# %wheel    ALL=(ALL)   ALL

yourusername ALL=(ALL) ALL

## Same thing without a password
...
```

</details>

- Với việc không muốn dùng password (Not recommend), sẽ thêm theo theo cú pháp `yourusername ALL=(ALL) NOPASSWD:ALL` vào sau dòng đó

<details>
    <summary>Config</summary>
    
```
...
## Same thing without a password
# %wheel    ALL=(ALL)   NOPASSWD:ALL

yourusername ALL=(ALL) NOPASSWD:ALL

## Allows members of the users group to mount and unmount the
...
```
</details></br>

Sau khi sửa file `sudoers`, mình sẽ cần chạy thêm câu lệnh sau để thêm user vào wheel group
```bash
usermod -aG wheel yourusername
```
